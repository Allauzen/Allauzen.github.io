---
title: "[PREVIEW] Exercices de probabilité (correction)"
date: 2017-09-04
layout: post
categories: 
tags: 
- cours 
- AIC17 
- exercices 
- probabilités
published: false
comments: 
---
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org1a497c0">1. Exercice d'introduction</a>
<ul>
<li><a href="#orgcaa95e1">1.1. Le problème des anniversaires (ou du conflit dans les tables de hashage)</a>
<ul>
<li><a href="#org09187ae">1.1.1. Correction</a></li>
</ul>
</li>
<li><a href="#orgbdbd861">1.2. Critique de film</a>
<ul>
<li><a href="#orgdf5cc4b">1.2.1. Correction</a></li>
</ul>
</li>
<li><a href="#org852f385">1.3. Estimation des paramètres pour une gaussienne</a>
<ul>
<li><a href="#org0c93b43">1.3.1. Correction</a></li>
</ul>
</li>
<li><a href="#org0ec1864">1.4. En passant</a>
<ul>
<li><a href="#orgba5fbd9">1.4.1. Correction</a>
<ul>
<li><a href="#org6c775e6">1.4.1.1. Binomiale / Bernoulli</a></li>
<li><a href="#org2eb2e2f">1.4.1.2. Loi de poisson</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#org2ab46cc">2. Le problèmes des urnes</a>
<ul>
<li><a href="#orgabc8575">2.1. En théorie</a>
<ul>
<li><a href="#org7f4d3f4">2.1.1. Correction</a></li>
</ul>
</li>
<li><a href="#org422b06f">2.2. En pratique</a>
<ul>
<li><a href="#orge0099f1">2.2.1. Correction</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org701ecb8">3. Passage à la dimension deux</a>
<ul>
<li><a href="#org33cea71">3.1. Estimation complète</a>
<ul>
<li><a href="#org99b890d">3.1.1. Correction</a></li>
</ul>
</li>
<li><a href="#org1b72d42">3.2. Estimation avec indépendance conditionnelle</a>
<ul>
<li><a href="#org10a45a7">3.2.1. Correction</a></li>
</ul>
</li>
<li><a href="#orgb5cc4bd">3.3. Un exemple réaliste</a>
<ul>
<li><a href="#org7192ac4">3.3.1. Présentation des données</a></li>
<li><a href="#orga5893fb">3.3.2. Les données</a>
<ul>
<li><a href="#org463e742">3.3.2.1. Votes des Républicain</a></li>
<li><a href="#orgfc5cf17">3.3.2.2. Votes des Démocrates</a></li>
</ul>
</li>
<li><a href="#org7bf127c">3.3.3. Correction</a></li>
</ul>
</li>
<li><a href="#org5eec09e">3.4. Introduction au cas continu</a>
<ul>
<li><a href="#org28382cd">3.4.1. En théorie</a></li>
<li><a href="#orgdacfd8c">3.4.2. Correction</a></li>
<li><a href="#org6f27cfc">3.4.3. Point de vue empirique</a></li>
<li><a href="#orgad2a04b">3.4.4. Correction</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgc33b9f7">4. La file d'attente</a>
<ul>
<li>
<ul>
<li><a href="#org7408c26">4.0.1. Correction</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<span style="background: red;">PREVIEW</span><hr>

<div class="LATEX">
<p>
\newpage
\setlength\parindent{0pt}
</p>

</div>


<p>
Certains de ces exercices sont des adaptations des exercices donnés
par F. Rossi. La plupart peuvent être fait sur papier. Certains
peuvent nécessiter des outils de calcul: pensez à Python. 
</p>

<p>
Ces exercices peuvent faire référence aux cours
(<a href="https://allauzen.github.io/cours/TC4_AIC">voir ici</a>). D'ailleurs il faut l'avoir lu avant. 
</p>

<div id="outline-container-org1a497c0" class="outline-2">
<h2 id="org1a497c0"><span class="section-number-2">1</span> Exercice d'introduction</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgcaa95e1" class="outline-3">
<h3 id="orgcaa95e1"><span class="section-number-3">1.1</span> Le problème des anniversaires (ou du conflit dans les tables de hashage)</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>De combien de personne a-t-on besoin dans cette pièce pour faire le pari "raisonnable" que 2 personnes ont la même date d'anniversaire ?</li>
<li>Quel est le rapport avec les table de hashage et le big-data ?</li>
</ul>
</div>

<div id="outline-container-org09187ae" class="outline-4">
<h4 id="org09187ae"><span class="section-number-4">1.1.1</span> Correction</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
La VA \(X\) : la date d'anniversaire d'une personne, il y en a 365  possibles.
</p>
<ul class="org-ul">
<li>Avec 183, cela devrait être bien ?</li>
<li>En fait, c'est raisonnable à partir de 23 !!</li>
<li>Pour le montrer considérons \(p_r\) la probabilité que \(r\) personnes aient toutes une date d'anniversaire différentes \(\Rightarrow\)</li>
<li>Une séquence de \(r\) tirage de \(X\) sans répétition :
\[
  p_r = \frac{365 \times 364 \times 363 \times ... \times (365-r+1)}{365^r}
  \]</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-orgbdbd861" class="outline-3">
<h3 id="orgbdbd861"><span class="section-number-3">1.2</span> Critique de film</h3>
<div class="outline-text-3" id="text-1-2">
<p>
Pour aller voir un film, dois-je me baser sur l'avis de mon critique préféré (ou ami facebook)
</p>

<ul class="org-ul">
<li>Notons A mon avis et B l'avis du critique sous forme de VA, par exemple A=1 si mon avis est positif, et A=0 sinon).</li>
<li>Ce critique est fiable à 95% :
<ul class="org-ul">
<li>95% des films que j'ai aimé sont recommandés par le
critique et</li>
<li>95% des films que je n'ai pas aimés sont déconseillés par le critique</li>
</ul></li>
<li>J'aime seulement 1% des films qui sortent</li>
</ul>
<p>
La critique de mon ami arrive, elle est positive. <b>Quel est la probabilité que j'aime ce film ?</b>
</p>


<p>
Pour répondre à cette question: 
</p>
<ul class="org-ul">
<li>définir les variables aléatoires nécessaires</li>
<li>reprendre les phrases de l'énoncé et les traduire en <i>probabilités</i>.</li>
<li>Pensez à appliquer la formule de Bayes</li>
</ul>
</div>

<div id="outline-container-orgdf5cc4b" class="outline-4">
<h4 id="orgdf5cc4b"><span class="section-number-4">1.2.1</span> Correction</h4>
<div class="outline-text-4" id="text-1-2-1">
<p>
Pour aller voir un film, dois-je me baser sur l'avis de mon critique préféré (ou ami facebook) ? 
</p>
<ul class="org-ul">
<li>Notons \(a\) mon avis et \(b\) l'avis du critique, par exemple \(a=1\) si mon avis est positif, et \(a=0\) sinon).</li>
<li>On a donc 2 VA : \(A,B\)</li>
<li><p>
On peut écrire: 
</p>
\begin{eqnarray*}
   P(b=1|a=1) = 0.95 &P(b=0|a=1) = 0.05 \\
   P(b=0|a=1) = 0.05 &P(b=1|a=0) = 0.05
 \end{eqnarray*}</li>
<li>De même pour les probabilités <i>a priori</i> : \(P(a=1) = 0.01\) et \(P(a=0)=0.99\).
\item Comment calculer l'evidence : \(P(b=1)\) ou \(P(b=0)\) ?</li>
</ul>
<p>
Ecrivons la quantité recherchée: 
\[
P(a=1 | b=1) = \frac{ P(b=1|a=1)P(a=1)}{P(b=1)}
\]
Il manque \(P(b=1)\): 
</p>
\begin{eqnarray*}
  P(b=1) &=& \sum_a P(b=1,a) \\
  &=& P(b=1|a=1)P(a=1) + P(b=1|a=0)P(a=0)
\end{eqnarray*}
<ul class="org-ul">
<li>16 % !</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org852f385" class="outline-3">
<h3 id="org852f385"><span class="section-number-3">1.3</span> Estimation des paramètres pour une gaussienne</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Soit \(X\) une VA continue que l'on suppose suivre la loi normale.  On dispose d'un ensemble de N observations \(x_{1:N}\) et nous souhaitons estimer les paramètres de la gaussienne à partir de ces données. 
Donner les valeurs des deux paramètres en fonction des données. Pour
cela, il faut suivre les étapes suivantes: 
</p>
<ul class="org-ul">
<li>écrire la vraisemblance</li>
<li>passer en log</li>
<li>dériver pour annuler et trouver les paramètres selon le max. de vraisemblance</li>
</ul>
</div>


<div id="outline-container-org0c93b43" class="outline-4">
<h4 id="org0c93b43"><span class="section-number-4">1.3.1</span> Correction</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
La vraissemblance est la probabilité assignée par le modèle aux données d'estimation: 
</p>
\begin{align*}
P(x_{1:N}) &= \prod_i P(x_i) \textrm{hypoth\`ese iid}\\
\log P(x_{1:N}) &= \sum_i \log P(x_i)\\
\log P(x_i) &= -log(\sqrt{2\pi}\sigma) -\frac{1}{2} (\frac{x_i-\mu}{\sigma})^2\\
\frac{\partial P(x_i) }{\partial \mu} &= (x_i-\mu)/\sigma^2\\
\frac{\partial P(x_{1:N}) }{\partial \mu} &= \sum_{i=1}^N (x_i-\mu)/\sigma^2\\
\frac{\partial P(x_{1:N}) }{\partial \mu} &= 0 \\
\Rightarrow  \sum_{i=1}^N (x_i-\mu) &= \sum_{i=1}^N x_i -N\mu = 0\\
\Rightarrow  \mu &= \frac{1}{N}\sum_{i=1}^N x_i
\end{align*}
</div>
</div>
</div>


<div id="outline-container-org0ec1864" class="outline-3">
<h3 id="org0ec1864"><span class="section-number-3">1.4</span> En passant</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li>Quelle est la différence entre une loi de Bernoulli et Binomiale ?</li>
<li>Qu'est-ce qu'une loi de Poisson ?</li>
<li>Dans le cours, il est question de la constante de normalisation de
la distribution multinomiale. Donner sa formule exacte et
expliquez la.</li>
</ul>
</div>

<div id="outline-container-orgba5fbd9" class="outline-4">
<h4 id="orgba5fbd9"><span class="section-number-4">1.4.1</span> Correction</h4>
<div class="outline-text-4" id="text-1-4-1">
</div>
<div id="outline-container-org6c775e6" class="outline-5">
<h5 id="org6c775e6"><span class="section-number-5">1.4.1.1</span> Binomiale / Bernoulli</h5>
<div class="outline-text-5" id="text-1-4-1-1">
<p>
La loi binomiale modélise le nombre de succès obtenus lors de la répétition indépendante de plusieurs expériences aléatoires identiques. Une manière visuelle de représenter cette suite d'expériences est d'utiliser un arbre de probabilité : à chaque génération de l'arbre, deux branches partent de chaque noeud, une pour le succès et une pour l'échec.
</p>

<p>
Plus mathématiquement, cette loi de probabilité discrète est décrite par deux paramètres : \(n\) le nombre d'expériences réalisées, et \(p\) la probabilité de succès. Pour chaque expérience appelée épreuve de Bernoulli, on utilise une variable aléatoire qui prend la valeur 1 lors d'un succès et la valeur 0 sinon. 
</p>

<p>
La variable aléatoire, somme de toutes ces variables aléatoires, compte le nombre de succès et est de loi binomiale. 
Il est alors possible d'obtenir la probabilité de \(k\) succès dans une répétition de \(n\) expériences :
\[ P(X=k)=\binom{n}{k} p^{k}(1-p)^{n-k}\]
avec: 
\[
\binom{n}{k}=C_{n}^{k}\,={\frac {n!}{k!(n-k)!}},
\]
le coefficient binomial. Qu'est-ce donc ? 
Pour l'expliquer, prenons \(n=4\)
</p>
<ul class="org-ul">
<li>\(k=1\), on doit placer 1 succès, on a 4 places et donc 4 possibilités</li>
<li>\(k=2\), on doit placer 2 succès:
<ul class="org-ul">
<li>pour le premier on a 4 possibilités, et pour chacune on a 3 places restantes pour le second</li>
<li>dont \(4\times 3\)</li>
</ul></li>
</ul>
<p>
De manière générale : 
\[
n(n-1)(n-2)...(n-k+1)=\frac{n!}{(n-k)!}
\]
Mais dans notre histoire avec \(n=4\) et \(k=2\) trop de combinaisons sont comptées: 
</p>
<ul class="org-ul">
<li>Pour placer le premier succès on a le choix parmi: \((x, x, x, x)\)</li>
<li>La première place est sélectionnée : \((1, x, x, x)\) et il reste 3 places pour le second succès</li>
<li>Pour le second, la troisième est prises et on obtient \((1, x, 1, x)\)</li>
</ul>
<p>
Mais l'inverse est possible: 
</p>
<ul class="org-ul">
<li>La troisième place est sélectionnée : \((x, x, 1, x)\) et il reste 3 places pour le second succès</li>
<li>et la première est sélectionnée \((1, x, 1, x)\)</li>
</ul>
<p>
On obtient la même chose. Donc \((1,x,1,x)\) est comptée deux fois et non une. 
Dans le cas général, une configuration telle que \((1, x, 1, 1)\) est invariante par permutation des succès et il y en \(k!\). 
</p>
</div>
</div>

<div id="outline-container-org2eb2e2f" class="outline-5">
<h5 id="org2eb2e2f"><span class="section-number-5">1.4.1.2</span> Loi de poisson</h5>
<div class="outline-text-5" id="text-1-4-1-2">
<p>
Loi qui caractérise les événements rares, une série de faits improbables, ou une supposée loi des séries. Par exemple, une suite de crashes d'avions ou de catastrophes ferroviaires.
La loi de Poisson décrit la probabilité qu'un événement se produise durant un intervalle de temps donné, alors
</p>
<ul class="org-ul">
<li>que la probabilité de réalisation d'un événement est très faible, et</li>
<li>que le nombre d'essais est très grand.</li>
</ul>
<p>
Ainsi on peut présenter cette distribution comme étant une approximation de la loi binomiale lorsque l’effectif \(n\) tend vers l’infini et la probabilité d'occurrence \(p\) tend vers zéro. Le produit np tend alors vers \(\lambda\). 
</p>

<p>
\[
P(X=k;\lambda)= \frac{\lambda^k e^{-\lambda}}{k!} 
\]
</p>

<p>
La probabilité qu'un événement se produire k fois exactement dans une période de temps sachant qu'il s'est déjà produit \(\lambda\) fois en moyenne sur cette même période de temps. 
\(\lambda\) est à la fois la moyenne et la variance. 
Exemple:  Sur ce trajet ferroviaire, nous avons constaté deux incidents par an. Quelle est la probabilité qu'il y en ait exactement dix en dix ans? 
</p>
<ul class="org-ul">
<li>2 par an, soit 2x10 = 20 en 10 ans</li>
<li>Sur dix ans la valeur espérée ou moyenne au sens statistique est  20</li>
</ul>
<p>
\[P(10;20)= \frac{\lambda^k e^{-\lambda}}{k!} = 20^10\times e^{-20}/10! = 0.0058\]
</p>
</div>
</div>
</div>
</div>
</div>





<div id="outline-container-org2ab46cc" class="outline-2">
<h2 id="org2ab46cc"><span class="section-number-2">2</span> Le problèmes des urnes</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgabc8575" class="outline-3">
<h3 id="orgabc8575"><span class="section-number-3">2.1</span> En théorie</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Soient deux urnes \(u_1\) et \(u_2\) contenant respectivement :
</p>
<ul class="org-ul">
<li>deux billes bleues et une bille rouge;</li>
<li>deux billes rouges et une bille bleue.</li>
</ul>
<p>
Les billes ne diffèrent entres elles que par leur couleur. On choisit une bille au hasard de la façon suivante :
</p>

<ul class="org-ul">
<li>on tire à pile ou face une urne (pièce non truquée) ;</li>
<li>si on obtient <i>pile</i> on choisit une bille dans l'urne \(u_1\)</li>
<li>sinon on choisit une bille dans \(u_2\)</li>
<li>on remet la bille ensuite dans son urne d'origine</li>
</ul>
<p>
On considère le couple de variables aléatoires \((U,C)\) où \(U\) désigne l'urne choisie et \(C\)
la couleur de la bille. L'objectif est
de prédire l'urne en connaissant la couleur de la bille obtenue.
</p>


<p>
Les questions:
</p>
<ul class="org-ul">
<li>Donner la loi (marginale) de \(U\)</li>
<li>Donner la loi (marginale) de \(C\)</li>
<li>Calculer \(P(U=u_1|C=rouge)\) et \(P(U=u_1|C=bleue)\)</li>
<li>En déduire le meilleur classifieur possible au sens de l'erreur
locale définie par le tableau suivant \[
   l(x,y)=\left\{\begin{array}{cc|cc} &y & u_1 & u_2\\\hline x &u_1&
   0& 1\\ &u_2&1&0\end{array} \right. \]</li>
<li>Calculer le risque du classifieur optimal.</li>
</ul>
</div>

<div id="outline-container-org7f4d3f4" class="outline-4">
<h4 id="org7f4d3f4"><span class="section-number-4">2.1.1</span> Correction</h4>
<div class="outline-text-4" id="text-2-1-1">
<ul class="org-ul">
<li>D'après l'énoncé, il est clair que \(P(U=u_1)=P(U=u_2)=0,5\).</li>
<li><p>
D'après l'énoncé, on a
</p>

<ul class="org-ul">
<li>\(P(C=rouge|U=u_1)=\frac{1}{3}\), et,</li>
<li>\(P(C=rouge|U=u_2)=\frac{2}{3}\).</li>
</ul>

<p>
En utilisant la règle des probabilités totales et la règle de Bayes,
on a
</p>

\begin{align*} P(C=rouge)=&P(C=rouge|U=u_1)P(U=u_1)\\
&+P(C=rouge|U=u_2)P(U=u_2)\\
=&\frac{1}{3}\times\frac{1}{2}+\frac{2}{3}\times\frac{1}{2}\\
=&\frac{1}{2} \end{align*}</li>

<li><p>
On applique la règle de Bayes qui donne ici
</p>

\begin{align*}
P(U=u_1|C=rouge)=&\frac{P(C=rouge|U=u_1)P(U=u_1)}{P(C=rouge)}\\ =&
\frac{\frac{1}{3}\times\frac{1}{2}}{\frac{1}{2}}\\ =&\frac{1}{3}
\end{align*}

<p>
Un calcul similaire conduit à \(P(U=u_1|C=bleue)=\frac{2}{3}\).
</p></li>

<li>On sait qu'avec l'erreur de comptage, le meilleur classifieur est
celui qui choisit la classe la plus probable à posteriori. En
utilisant le calcul de la question 3, on obtient \(g(rouge)=u_2\) et
\(g(bleue)=u_1\).</li>
<li>On obtient facilement \(L(g)=\frac{1}{3}\).</li>
</ul>
</div>
</div>
</div>



<div id="outline-container-org422b06f" class="outline-3">
<h3 id="org422b06f"><span class="section-number-3">2.2</span> En pratique</h3>
<div class="outline-text-3" id="text-2-2">
<p>
On observe maintenant les tirages sous forme de réalisation des couples
i.i.d. de (U,C): 
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">U</th>
<th scope="col" class="org-left">C</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left">rouge</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">bleue</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">bleue</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">bleue</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">rouge</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">rouge</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">bleue</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">bleue</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">rouge</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">bleue</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">bleue</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">rouge</td>
</tr>
</tbody>
</table>

<p>
Ce sont les données d'apprentissage.
</p>

<ul class="org-ul">
<li>Estimer les lois marginales de \(U\) et \(C\) d'après le tableau.</li>
<li>Estimer \(P(U=u_1|C=rouge)\) et \(P(U=u_1|C=bleue)\) d'après le
tableau.</li>
</ul>
</div>

<div id="outline-container-orge0099f1" class="outline-4">
<h4 id="orge0099f1"><span class="section-number-4">2.2.1</span> Correction</h4>
<div class="outline-text-4" id="text-2-2-1">
<ul class="org-ul">
<li>Un simple comptage donne \(P(U=u_1)=\frac{7}{12}\) et
\(P(C=rouge)=\frac{5}{12}\).</li>
<li>On trouve aussi par comptage \(P(U=u_1|C=rouge)=\frac{2}{5}\) et
\(P(U=u_1|C=bleue)=\frac{5}{7}\).</li>
</ul>
</div>
</div>
</div>
</div>


<div id="outline-container-org701ecb8" class="outline-2">
<h2 id="org701ecb8"><span class="section-number-2">3</span> Passage à la dimension deux</h2>
<div class="outline-text-2" id="text-3">
<p>
On étudie un problème de classement entre deux classes 1 et 2
pour des objets caractérisés par deux variables :
</p>

<ul class="org-ul">
<li><b>T</b> la taille qui prend les valeurs <i>S</i>, <i>M</i> et <i>L</i> (<i>small</i>,
<i>medium</i> et <i>large</i>) ;</li>
<li><b>P</b> le poids, qui prend les valeurs 1, 2 ou 3.</li>
</ul>
</div>

<div id="outline-container-org33cea71" class="outline-3">
<h3 id="org33cea71"><span class="section-number-3">3.1</span> Estimation complète</h3>
<div class="outline-text-3" id="text-3-1">
<p>
On observe des exemples d'objets de chaque classe selon le tableau
suivant (les données d'apprentissage) :
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">classe</th>
<th scope="col" class="org-left">T</th>
<th scope="col" class="org-right">P</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left">S</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">S</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">M</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">L</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">S</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">M</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">M</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">L</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">M</td>
<td class="org-right">1</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">L</td>
<td class="org-right">2</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">L</td>
<td class="org-right">3</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">L</td>
<td class="org-right">2</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>Pour effectuer la classification, quelles sont les probabilités conditionnelles nécessaires ?</li>
<li>Estimer ces probabilités à partir du tableau.</li>
<li>Quel problème rencontre-t-on ? Quel remède ?</li>
</ul>
</div>

<div id="outline-container-org99b890d" class="outline-4">
<h4 id="org99b890d"><span class="section-number-4">3.1.1</span> Correction</h4>
<div class="outline-text-4" id="text-3-1-1">
<ul class="org-ul">
<li>On a besoin de \(P(classe=1|T=t,P=p)\) pour les neuf combinaisons
possibles de t et p.</li>
<li><p>
Les probabilités sont les suivantes :
</p>

\begin{array}{cc|ccc} &P & 1 & 2 & 3\\\hline T&S&1 &1 &NA\\
&M&0,5&1&1\\ &L&NA&0,25&0 \end{array}

<p>
<i>NA</i> désigne une probabilité qui ne peut pas être estimée car le
couple concerné n'a pas été observé dans les données.
</p></li>

<li>On ne peut pas prendre de décision pour les couples (S,3) et
(L,1).</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-org1b72d42" class="outline-3">
<h3 id="org1b72d42"><span class="section-number-3">3.2</span> Estimation avec indépendance conditionnelle</h3>
<div class="outline-text-3" id="text-3-2">
<p>
On fait maintenant l'hypothèse d'indépendance conditionnelle du
classifieur bayesien naïf.
</p>

<ul class="org-ul">
<li>Calculer les lois empiriques de T et P dans les deux classes.</li>
</ul>
</div>

<div id="outline-container-org10a45a7" class="outline-4">
<h4 id="org10a45a7"><span class="section-number-4">3.2.1</span> Correction</h4>
<div class="outline-text-4" id="text-3-2-1">
<ul class="org-ul">
<li><p>
On obtient :
</p>

\begin{array}{l|ccc} p&1&2&3\\\hline P(P=p|classe=1)&0,5&0,5&0\\
P(P=p|classe=2)&\frac{1}{6}&\frac{1}{2}&\frac{1}{3}\\\hline
\end{array}

<p>
et
</p>

\begin{array}{l|ccc} t&S&M&L\\\hline
P(T=t|classe=1)&\frac{1}{2}&\frac{1}{3}&\frac{1}{6}\\
P(T=t|classe=2)&0&\frac{1}{3}&\frac{2}{3}\\\hline \end{array}</li>

<li><p>
D'après l'hypothèse d'indépendance conditionnelle, on a \[
   P(classe=1|P=p,T=t)=\frac{P(P=p|classe=1)P(T=t|classe=1)P(classe=1)}{P(P=p,T=t)}
   \] Comme \(P(classe=1)=P(classe=2)\), on peut se contenter de
comparer \(P(P=p|classe=1)P(T=t|classe=1)\) avec
\(P(P=p|classe=2)P(T=t|classe=2)\).
</p>

<p>
On obtient le tableau suivant pour la classe 1 :
</p>

\begin{array}{cc|ccc} &P & 1 & 2 & 3\\\hline T&S&\frac{1}{4}
&\frac{1}{4} &0\\ &M&\frac{1}{6}&\frac{1}{6}&0\\
&L&\frac{1}{12}&\frac{1}{12}&0 \end{array}

<p>
et pour la classe 2 :
</p>

\begin{array}{cc|ccc} &P & 1 & 2 & 3\\\hline T&S&0 &0 &0\\
&M&\frac{1}{18}&\frac{1}{6}&\frac{1}{9}\\
&L&\frac{1}{9}&\frac{1}{3}&\frac{2}{9} \end{array}

<p>
Les décisions sont donc :
</p>

\begin{array}{cc|ccc} &P & 1 & 2 & 3\\\hline T&S&1 &1 &tie\\
&M&1&tie&2\\ &L&2&2&2\\ \end{array}

<p>
On constate la présence de deux cas d'égalité.
</p>

<p>
Ceci conduit à 2,5 erreurs, soit un risque de \frac{5}{24}.
</p></li>
</ul>
</div>
</div>
</div>


<div id="outline-container-orgb5cc4bd" class="outline-3">
<h3 id="orgb5cc4bd"><span class="section-number-3">3.3</span> Un exemple réaliste</h3>
<div class="outline-text-3" id="text-3-3">
</div>
<div id="outline-container-org7192ac4" class="outline-4">
<h4 id="org7192ac4"><span class="section-number-4">3.3.1</span> Présentation des données</h4>
<div class="outline-text-4" id="text-3-3-1">
<p>
On considère la base de données des votes effectués par les membres de
la Chambre des représentants des EUA en 1984 sur 16 propositions
importantes. Chaque individu est un membre de la Chambre décrit par 17
variables nominales. La variable Parti prend les modalités Démocrate et
Républicain. Les autres variables, V1 à V16 représentent les votes et
prennent les valeurs OUI, NON et NSP (pour une absence de vote). Il y a
267 représentants démocrates et 168 représentants républicains.
</p>
</div>
</div>

<div id="outline-container-orga5893fb" class="outline-4">
<h4 id="orga5893fb"><span class="section-number-4">3.3.2</span> Les données</h4>
<div class="outline-text-4" id="text-3-3-2">
</div>
<div id="outline-container-org463e742" class="outline-5">
<h5 id="org463e742"><span class="section-number-5">3.3.2.1</span> Votes des Républicain</h5>
<div class="outline-text-5" id="text-3-3-2-1">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">NON</th>
<th scope="col" class="org-right">NSP</th>
<th scope="col" class="org-right">OUI</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">V1</td>
<td class="org-right">134</td>
<td class="org-right">3</td>
<td class="org-right">31</td>
</tr>

<tr>
<td class="org-left">V2</td>
<td class="org-right">73</td>
<td class="org-right">20</td>
<td class="org-right">75</td>
</tr>

<tr>
<td class="org-left">V3</td>
<td class="org-right">142</td>
<td class="org-right">4</td>
<td class="org-right">22</td>
</tr>

<tr>
<td class="org-left">V4</td>
<td class="org-right">2</td>
<td class="org-right">3</td>
<td class="org-right">163</td>
</tr>

<tr>
<td class="org-left">V5</td>
<td class="org-right">8</td>
<td class="org-right">3</td>
<td class="org-right">157</td>
</tr>

<tr>
<td class="org-left">V6</td>
<td class="org-right">17</td>
<td class="org-right">2</td>
<td class="org-right">149</td>
</tr>

<tr>
<td class="org-left">V7</td>
<td class="org-right">123</td>
<td class="org-right">6</td>
<td class="org-right">39</td>
</tr>

<tr>
<td class="org-left">V8</td>
<td class="org-right">133</td>
<td class="org-right">11</td>
<td class="org-right">24</td>
</tr>

<tr>
<td class="org-left">V9</td>
<td class="org-right">146</td>
<td class="org-right">3</td>
<td class="org-right">19</td>
</tr>

<tr>
<td class="org-left">V10</td>
<td class="org-right">73</td>
<td class="org-right">3</td>
<td class="org-right">92</td>
</tr>

<tr>
<td class="org-left">V11</td>
<td class="org-right">138</td>
<td class="org-right">9</td>
<td class="org-right">21</td>
</tr>

<tr>
<td class="org-left">V12</td>
<td class="org-right">20</td>
<td class="org-right">13</td>
<td class="org-right">135</td>
</tr>

<tr>
<td class="org-left">V13</td>
<td class="org-right">22</td>
<td class="org-right">10</td>
<td class="org-right">136</td>
</tr>

<tr>
<td class="org-left">V14</td>
<td class="org-right">3</td>
<td class="org-right">7</td>
<td class="org-right">158</td>
</tr>

<tr>
<td class="org-left">V15</td>
<td class="org-right">142</td>
<td class="org-right">12</td>
<td class="org-right">14</td>
</tr>

<tr>
<td class="org-left">V16</td>
<td class="org-right">50</td>
<td class="org-right">22</td>
<td class="org-right">96</td>
</tr>
</tbody>
</table>
</div>
</div>


<div id="outline-container-orgfc5cf17" class="outline-5">
<h5 id="orgfc5cf17"><span class="section-number-5">3.3.2.2</span> Votes des Démocrates</h5>
<div class="outline-text-5" id="text-3-3-2-2">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">&#xa0;</th>
<th scope="col" class="org-right">NON</th>
<th scope="col" class="org-right">NSP</th>
<th scope="col" class="org-right">OUI</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">V1</td>
<td class="org-right">102</td>
<td class="org-right">9</td>
<td class="org-right">156</td>
</tr>

<tr>
<td class="org-left">V2</td>
<td class="org-right">119</td>
<td class="org-right">28</td>
<td class="org-right">120</td>
</tr>

<tr>
<td class="org-left">V3</td>
<td class="org-right">29</td>
<td class="org-right">7</td>
<td class="org-right">231</td>
</tr>

<tr>
<td class="org-left">V4</td>
<td class="org-right">245</td>
<td class="org-right">8</td>
<td class="org-right">14</td>
</tr>

<tr>
<td class="org-left">V5</td>
<td class="org-right">200</td>
<td class="org-right">12</td>
<td class="org-right">55</td>
</tr>

<tr>
<td class="org-left">V6</td>
<td class="org-right">135</td>
<td class="org-right">9</td>
<td class="org-right">123</td>
</tr>

<tr>
<td class="org-left">V7</td>
<td class="org-right">59</td>
<td class="org-right">8</td>
<td class="org-right">200</td>
</tr>

<tr>
<td class="org-left">V8</td>
<td class="org-right">45</td>
<td class="org-right">4</td>
<td class="org-right">218</td>
</tr>

<tr>
<td class="org-left">V9</td>
<td class="org-right">60</td>
<td class="org-right">19</td>
<td class="org-right">188</td>
</tr>

<tr>
<td class="org-left">V10</td>
<td class="org-right">139</td>
<td class="org-right">4</td>
<td class="org-right">124</td>
</tr>

<tr>
<td class="org-left">V11</td>
<td class="org-right">126</td>
<td class="org-right">12</td>
<td class="org-right">129</td>
</tr>

<tr>
<td class="org-left">V12</td>
<td class="org-right">213</td>
<td class="org-right">18</td>
<td class="org-right">36</td>
</tr>

<tr>
<td class="org-left">V13</td>
<td class="org-right">179</td>
<td class="org-right">15</td>
<td class="org-right">73</td>
</tr>

<tr>
<td class="org-left">V14</td>
<td class="org-right">167</td>
<td class="org-right">10</td>
<td class="org-right">90</td>
</tr>

<tr>
<td class="org-left">V15</td>
<td class="org-right">91</td>
<td class="org-right">16</td>
<td class="org-right">160</td>
</tr>

<tr>
<td class="org-left">V16</td>
<td class="org-right">12</td>
<td class="org-right">82</td>
<td class="org-right">173</td>
</tr>
</tbody>
</table>



<ul class="org-ul">
<li>Les tables ci-dessus représentent les votes de chaque parti aux 16
propositions. Quelles grandeurs nécessaires à la mise en oeuvre d'un
classifieur bayésien naïf peuvent être évaluées grâce à cette table ?</li>
<li><p>
Soit un représentant ayant voté selon le vecteur de réponse V
suivant :
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">V1</th>
<th scope="col" class="org-left">V2</th>
<th scope="col" class="org-left">V3</th>
<th scope="col" class="org-left">V4</th>
<th scope="col" class="org-left">V5</th>
<th scope="col" class="org-left">V6</th>
<th scope="col" class="org-left">V7</th>
<th scope="col" class="org-left">V8</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">OUI</td>
<td class="org-left">NON</td>
<td class="org-left">NSP</td>
<td class="org-left">OUI</td>
<td class="org-left">NON</td>
<td class="org-left">OUI</td>
<td class="org-left">OUI</td>
<td class="org-left">OUI</td>
</tr>
</tbody>
</table></li>
</ul>

<p>
et puis 
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">V9</th>
<th scope="col" class="org-left">V10</th>
<th scope="col" class="org-left">V11</th>
<th scope="col" class="org-left">V12</th>
<th scope="col" class="org-left">V13</th>
<th scope="col" class="org-left">V14</th>
<th scope="col" class="org-left">V15</th>
<th scope="col" class="org-left">V16</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">NON</td>
<td class="org-left">NON</td>
<td class="org-left">OUI</td>
<td class="org-left">NON</td>
<td class="org-left">NON</td>
<td class="org-left">NON</td>
<td class="org-left">NON</td>
<td class="org-left">OUI</td>
</tr>
</tbody>
</table>

<p>
Donner le rapport de probabilités
\[\frac{P(\text{Démocrate}\mid
   V)}{P(\text{Républicain}\mid V)},\] tel qu'estimé par le classifieur
bayésien naïf. On rappelle qu'il y 267 représentants démocrates et
168 représentants républicains.
</p>
</div>
</div>
</div>

<div id="outline-container-org7bf127c" class="outline-4">
<h4 id="org7bf127c"><span class="section-number-4">3.3.3</span> Correction</h4>
<div class="outline-text-4" id="text-3-3-3">
<p>
Pour mettre en oeuvre le classifieur bayésien, il faut estimer les probabilités à priori des deux classes, soit P(\text{Démocrate}) et P(\text{Républicain}), ce qui se fait simplement à partir des effectifs. Il faut aussi pouvoir calculer la loi de chaque variable V1 à V16 conditionnellement à chaque classe, ce qui se fait aussi simplement en utilisant les tableaux. Par exemple : 
</p>

<p>
\[ 
P(V1=OUI|Démocrate)=\frac{156}{267}
\]
</p>

<p>
On applique l'hypothèse d'indépendance conditionnelle, ce qui conduit en appliquant la règle de Bayes à: 
\[
\frac{P(\text{Démocrate}\mid V=v)}{P(\text{Républicain}\mid V=v)} =\frac{\prod_{i=1}^{16} P(V_i=v_i|\text{Démocrate})}{\prod_{i=1}^{16} P(V_i=v_i|\text{Démocrate})}\frac{P(\text{Démocrate})}{P(\text{Républicain})}.
\] 
On remplace dans cette formule les v<sub>i</sub> par les votes indiqués
   dans le tableau (par exemple v<sub>1</sub>=OUI). Ainsi,
   &prod;<sub>i=1</sub><sup>16</sup> P(V<sub>i</sub>=v<sub>i</sub>|\text{Démocrate}) s'écrit \[
   \frac{156}{267}\frac{119}{267}\cdots\frac{91}{267}\frac{173}{267}\simeq
   3,15\ 10^{-7}. \] Comme ce nombre est très petit, on passe souvent
   au logarithme, ce qui donne ici environ -14,96926. De la même
   façon, on obtient pour &prod;<sub>i=1</sub><sup>16</sup>
   P(V<sub>i</sub>=v<sub>i</sub>|\text{Républicain}) \[
   \frac{31}{168}\frac{73}{168}\cdots\frac{142}{168}\frac{96}{267}\simeq
   9,94\ 10^{-15}, \] dont le logarithme est environ -32,24233. Le
   rapport des probabilités est alors environ \[ \frac{3,15\
   10^{-7}}{9,94\ 10^{-15}}\frac{267}{168}\simeq 50442988. \] De
   nouveau, on préfère travailler sur les logarithmes et donc faire la
   différence entre les deux logarithmes, ce qui donne environ
   17,73635. Ce nombre étant supérieur à 0 (le rapport étant
   supérieur à 1), on conclut que pour ce profil de vote, le votant est
   beaucoup plus probablement démocrate que républicain.
</p>
</div>
</div>
</div>



<div id="outline-container-org5eec09e" class="outline-3">
<h3 id="org5eec09e"><span class="section-number-3">3.4</span> Introduction au cas continu</h3>
<div class="outline-text-3" id="text-3-4">
</div>
<div id="outline-container-org28382cd" class="outline-4">
<h4 id="org28382cd"><span class="section-number-4">3.4.1</span> En théorie</h4>
<div class="outline-text-4" id="text-3-4-1">
<p>
On considère deux populations, les hommes H de taille moyenne 1,74m
avec un écart type de 0,07m et les femmes F de taille moyenne 1,62m
avec un écart type de 0,065m (chiffres INSEE 2001). La population H
contient h individus et la population F, f individus. On
suppose que les répartitions des tailles sont gaussiennes au sein de
chaque sous-population.
</p>

<p>
On choisit aléatoirement uniformément un individu dans la population
totale et on veut déterminer en fonction de sa taille uniquement de
quelle sous-population il est issu : il s'agit donc de classer les
individus en fonction d'une variable continue.
</p>



<ul class="org-ul">
<li>On note G la variable aléatoire indiquant le genre d'une personne
choisie au hasard. Donner la loi de G</li>
<li>On note T la variable aléatoire donnant la taille d'une personne
choisie au hasard. Donner la densité de T.</li>
<li>Calculer \(P(G=f|T=t)\).</li>
</ul>
</div>
</div>


<div id="outline-container-orgdacfd8c" class="outline-4">
<h4 id="orgdacfd8c"><span class="section-number-4">3.4.2</span> Correction</h4>
<div class="outline-text-4" id="text-3-4-2">
<ul class="org-ul">
<li>Le choix est uniforme dans une population de h+f individus. On a
donc \(P(G=f)=\frac{f}{f+h}\).</li>
<li>On sait que P(T|G=h) (resp. P(T|G=f)) correspond à une loi
normale. De plus, selon la règle des probabilités totales, on a 
\[
   p(t)=p(t|G=h)P(G=h)+p(t|G=f)P(G=f)\] soit \[
   p(t)=\frac{1}{\sqrt{2\pi}(f+h)}\left(\frac{h}{0,07}e^{-\frac{(t-1,74)^2}{0,0098}}+\frac{f}{0,065}e^{-\frac{(t-1,62)^2}{0,00845}}\right)
   \]</li>
<li>D'après la règle de Bayes, on a \[
   P(G=f|T=t)=\frac{p(T=t|G=f)P(G=f)}{p(t)} \] Sans développer p(t),
on a alors \[
   P(G=f|T=t)=\frac{\frac{f}{0,065\sqrt{2\pi}(f+h)}e^{-\frac{(t-1,62)^2}{0,00845}}}{p(t)}
   \]</li>
<li><p>
Dans le cas de l'erreur de comptage, le classifieur optimal est celui
qui « décide » la classe la plus probable à posteriori. On calcule
donc \[
   R(t)=\frac{P(G=f|T=t)}{P(G=f|T=t)}=\frac{p(T=t|G=f)P(G=f)}{p(T=t|G=h)P(G=h)},
   \] ce qui donne après simplification \[
   R(t)=\frac{0,07fe^{-\frac{(t-1,62)^2}{0,00845}}}{0,065he^{-\frac{(t-1,74)^2}{0,0098}}}.
   \] Comme souvent, on travaille plus facilement sur le log, soit \[
   \log R(t)=\log f-\log h+\log 0,07-\log
   0,065+\frac{(t-1,74)^2}{0,0098}-\frac{(t-1,62)^2}{0,00845} \] On
reconnaît un polynôme de degré 2 en t dont on analyse le signe en
fonction de t de façon classique (à partir des racines). On écrit
d'abord log R(t) sous la forme suivante : \[ \log R(t)=a t^2+b
   t+c, \] avec
</p>

<ul class="org-ul">
<li>\(a=\frac{1}{0,0098}-\frac{1}{0,00845}\simeq -16,3 ;\)</li>
<li>\(b=-\frac{2\times 1,74}{0,0098}+\frac{2\times
      1,62}{0,00845}\simeq -28,33 ;\)</li>
<li>et \(c=\log f-\log h+\log 0,07-\log
      0,065+\frac{1,74^2}{0.0098}-\frac{1,62^2}{0.00845}\simeq \log
      f-\log h-1.57\)</li>
</ul>

<p>
Comme a est négatif, R(t) est négatif avant la première
racine du polynôme (si une telle racine existe), positif entre les
deux racines, puis de nouveau négatif. On décide donc H avant la
première racine, F entre les deux, puis de nouveau H.
</p></li>

<li><p>
On obtient alors c&cong; -1,57. Le discriminant
&Delta;=b<sup>2</sup>-4ac vaut donc &Delta;&cong; 700,4 et les deux
racines sont donc :
</p>

<ul class="org-ul">
<li>\(r_1= \frac{-b+\sqrt{\Delta}}{2a}\simeq 0,057\)</li>
<li>\(r_2= \frac{-b-\sqrt{\Delta}}{2a}\simeq 1,681\)</li>
</ul>

<p>
On décide donc :
</p>

<ul class="org-ul">
<li>H si \(t\leq 0,057\) ou \(t\geq 1,681\),</li>
<li>et F sinon.</li>
</ul></li>

<li>La décision pour la petite racine peut sembler étrange. En fait, elle
s'explique simplement en raison de la variance plus importante des
tailles des hommes.</li>
</ul>
</div>
</div>


<div id="outline-container-org6f27cfc" class="outline-4">
<h4 id="org6f27cfc"><span class="section-number-4">3.4.3</span> Point de vue empirique</h4>
<div class="outline-text-4" id="text-3-4-3">
<p>
On observe maintenant des exemples de la population considérée, décrits
par la table ci-dessous.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">&#xa0;</th>
<th scope="col" class="org-left">Genre</th>
<th scope="col" class="org-right">Taille</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left">Femme</td>
<td class="org-right">1.83</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">Femme</td>
<td class="org-right">1.72</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">Femme</td>
<td class="org-right">1.83</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">Femme</td>
<td class="org-right">1.83</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">Femme</td>
<td class="org-right">1.77</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-left">Femme</td>
<td class="org-right">1.63</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-left">Femme</td>
<td class="org-right">1.68</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-left">Femme</td>
<td class="org-right">1.72</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-left">Femme</td>
<td class="org-right">1.74</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-left">Femme</td>
<td class="org-right">1.91</td>
</tr>

<tr>
<td class="org-right">11</td>
<td class="org-left">Homme</td>
<td class="org-right">1.67</td>
</tr>

<tr>
<td class="org-right">12</td>
<td class="org-left">Homme</td>
<td class="org-right">1.57</td>
</tr>

<tr>
<td class="org-right">13</td>
<td class="org-left">Homme</td>
<td class="org-right">1.55</td>
</tr>

<tr>
<td class="org-right">14</td>
<td class="org-left">Homme</td>
<td class="org-right">1.60</td>
</tr>

<tr>
<td class="org-right">15</td>
<td class="org-left">Homme</td>
<td class="org-right">1.60</td>
</tr>

<tr>
<td class="org-right">16</td>
<td class="org-left">Homme</td>
<td class="org-right">1.59</td>
</tr>

<tr>
<td class="org-right">17</td>
<td class="org-left">Homme</td>
<td class="org-right">1.64</td>
</tr>

<tr>
<td class="org-right">18</td>
<td class="org-left">Homme</td>
<td class="org-right">1.56</td>
</tr>

<tr>
<td class="org-right">19</td>
<td class="org-left">Homme</td>
<td class="org-right">1.65</td>
</tr>

<tr>
<td class="org-right">20</td>
<td class="org-left">Homme</td>
<td class="org-right">1.54</td>
</tr>
</tbody>
</table>


<ul class="org-ul">
<li>Quelles hypothèses permettent de se ramener au cas théorique ?</li>
<li>Quelles grandeurs doit-on calculer pour définir le classifieur ?</li>
</ul>
</div>
</div>




<div id="outline-container-orgad2a04b" class="outline-4">
<h4 id="orgad2a04b"><span class="section-number-4">3.4.4</span> Correction</h4>
<div class="outline-text-4" id="text-3-4-4">
<ul class="org-ul">
<li>On suppose que conditionnellement à la classe, la distribution de la
taille suit une loi normale.</li>
<li><p>
Il faut calculer les moyennes et variances empiriques dans chaque
classe. Ici, on trouve :
</p>
<ul class="org-ul">
<li>pour les hommes, &mu;&cong; 1,766 et &sigma;&cong; 0,084 ;</li>
<li>pour les femmes, &mu;&cong; 1,597 et &sigma;&cong; 0,044.</li>
</ul>

<p>
On peut ensuite reprendre les calculs précédents pour déterminer les
seuils de décision.
</p></li>
</ul>
</div>
</div>
</div>
</div>


<div id="outline-container-orgc33b9f7" class="outline-2">
<h2 id="orgc33b9f7"><span class="section-number-2">4</span> La file d'attente</h2>
<div class="outline-text-2" id="text-4">
<p>
Un poste de péage d'une autoroute possède plusieurs guichets. En période de pointe et dans la tranche horaire 7h-9h, on compte 6300 véhicules par heure.
</p>

<p>
Des compteurs, à la sortie du péage, ont montré qu'un usager met en
moyenne 18 secondes pour s'acquitter du péage. On estime qu'il y a risque de saturation (création d'un bouchon) si on compte plus de 10 véhicules en attente à chaque guichet. On se place désormais dans la période considérée 7h-9h.
</p>

<ul class="org-ul">
<li>Le nombre de véhicules présents au péage à un instant donné est une variable aléatoire X. Quelle est sa loi ? Quelle est son espérance mathématique E(X) : nombre moyen de véhicules présents au péage à un instant donné ?</li>

<li>Dans le cas où il y a 5 guichets, en admettant une égale répartition des véhicules sur chaque guichet et en notant Y le nombre de véhicules se présentant à un guichet à un instant donné, justifier que Y suit sensiblement une loi de Poisson et calculer la probabilité de saturation, à savoir le nombre Prob(Y &gt; 10).</li>

<li>On suppose le nombre g de guichets non précisé. Quelle est la valeur minimale à attribuer à g afin que la probabilité de saturation n'excède pas 0,01 ?</li>
</ul>
</div>

<div id="outline-container-org7408c26" class="outline-4">
<h4 id="org7408c26"><span class="section-number-4">4.0.1</span> Correction</h4>
<div class="outline-text-4" id="text-4-0-1">
<p>
L'arrivée d'un véhicule au péage est une épreuve de Bernoulli dont la probabilité de l'observer dans la période considérée est
\[
p = 18/(2 × 3600) = 0,0025
\]
Sur cette période l'épreuve est répétée n = 12600 fois et les éventualités étant a priori indépendantes les unes des autres, on est en présence d'une loi binomiale. Le nombre moyen de véhicules est alors \(np = 31,5\).
</p>

<p>
Pour un guichet donné, \(Y\) suit une loi binomiale B(n,p') de paramètres n = 12600 et p' = p × 1/5 = 0,0005, de moyenne n × p' = 6,3 (c'est aussi 31,5/5) approximable par une loi de Poisson de paramètre (moyenne) 6,3 &lt; 10 : on peut espérer une probabilité non négligeable de non saturation :
\[
P(Y > 10) = 1 - P(Y < 10) 0,056 
\]
Soit en python : 1-poisson.cdf(10,6.3)
Procédons (approximativement) par dichotomie sur le nombre de guichets :
</p>
<ul class="org-ul">
<li>5 guichets : \(P(Y > 10) = 0,056 > 0,01\)</li>
<li>10 guichets : paramètre 3,15 = 31,5/10; \(P(Y > 10)  = 0,000437 < 0,01\)</li>
<li>8 guichets : paramètre 31,5/8; \(P(Y > 10) 0,002... < 0,01\)</li>
<li>6 guichets : paramètre 31,5/6; \(P(Y > 10) 0,0188 > 0,01\)</li>
</ul>
<p>
Donc 7 guichets suffisent. 
</p>
</div>
</div>
</div>
